### **3-1. 데이터베이스 기초**

#### **1. 데이터베이스란 무엇인가?**

데이터베이스(DB)는 간단히 말해 '데이터의 체계적인 모음'입니다. 애플리케이션의 데이터를 안전하고 효율적으로 저장, 수정, 삭제, 조회(CRUD)할 수 있도록 관리해주는 소프트웨어 시스템입니다. 애플리케이션이 종료되거나 서버 컴퓨터가 재시작되어도 데이터가 사라지지 않고 영구적으로 보존되는 것이 가장 큰 특징입니다.

#### **2. 관계형 데이터베이스 (RDBMS)**

세상에는 여러 종류의 데이터베이스가 있지만, 가장 널리 쓰이는 모델은 **관계형 데이터베이스(Relational Database Management System, RDBMS)**입니다. 데이터를 엑셀 시트처럼 생긴 **테이블(Table)**이라는 2차원 표 형태로 저장하고 관리합니다.

RDBMS의 핵심 구성 요소를 알아봅시다.

-   **테이블 (Table)**
    데이터가 실질적으로 저장되는 공간입니다. 하나의 테이블은 연관된 데이터들의 집합입니다. 예를 들어, '회원' 정보를 저장하는 `USER` 테이블, '게시글' 정보를 저장하는 `POST` 테이블처럼 주제에 맞게 생성합니다.

-   **행 (Row / Record)**
    테이블의 가로 한 줄에 해당하는 데이터 단위입니다. 한 명의 회원 정보, 한 개의 게시글 등 개별적인 데이터 항목 하나를 의미합니다.

-   **열 (Column / Field / Attribute)**
    테이블의 세로 한 줄에 해당하는 데이터의 속성입니다. `USER` 테이블이라면 `user_id`, `username`, `email`, `password` 등이 각각의 열이 될 수 있습니다. 각 열은 `VARCHAR`(문자열), `INT`(정수), `DATETIME`(날짜) 등 정해진 데이터 타입(Data Type)을 가집니다.

-   **기본 키 (Primary Key, PK)**
    테이블의 각 행(Row)을 **고유하게 식별**할 수 있는 값을 가진 열입니다. PK는 절대 중복될 수 없으며, 비어 있을 수도 없습니다(NULL 불가). 예를 들어, `USER` 테이블의 `user_id`나 주민등록번호처럼 각 데이터를 유일하게 구분해주는 값입니다.

-   **외래 키 (Foreign Key, FK)**
    한 테이블의 열이 다른 테이블의 기본 키(PK)를 참조하는 것입니다. 테이블 간의 '관계'를 맺어주는 핵심적인 역할을 합니다. 예를 들어, `POST` 테이블에 `user_id`라는 열을 만들어 `USER` 테이블의 `user_id`를 참조하게 하면, '어떤 사용자가 이 게시글을 작성했는지'를 명확하게 알 수 있습니다.

| `USER` 테이블 (PK: `user_id`) | | `POST` 테이블 (PK: `post_id`, FK: `author_id` -> `USER.user_id`) |
| :--- | :--- | :--- |
| **user_id** | **username** | | **post_id** | **title** | **author_id** |
| 1 | 'Gemini' | | 101 | '첫 게시글' | 1 |
| 2 | 'Thomas' | | 102 | '두 번째 글' | 1 |

위 예시에서 `POST` 테이블의 `author_id`는 `USER` 테이블의 `user_id`를 참조하는 외래 키(FK)입니다. 이를 통해 101번, 102번 게시글 모두 'Gemini'라는 사용자가 작성했음을 알 수 있습니다.

---

### **기본적인 SQL 명령어 (Basic SQL)**

데이터베이스와 소통하기 위해서는 **SQL(Structured Query Language)**이라는 언어를 사용합니다. 위에서 설명한 개념들을 SQL로 어떻게 다루는지 알아봅시다.

- **`CREATE` (테이블 생성)**: `USER` 테이블을 만드는 예시입니다.
```sql
CREATE TABLE USER (
    user_id BIGINT AUTO_INCREMENT PRIMARY KEY, -- 자동 증가하는 숫자, 기본 키
    username VARCHAR(255) NOT NULL, -- 255자까지의 문자열, 비어있을 수 없음
    email VARCHAR(255) UNIQUE, -- 고유한 값이어야 함
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP -- 현재 시간이 자동으로 기록됨
);
```

- **`INSERT` (데이터 추가)**: `USER` 테이블에 새로운 회원 정보를 추가합니다.
```sql
INSERT INTO USER (username, email) VALUES ('Gemini', 'gemini@google.com');
```

- **`SELECT` (데이터 조회)**: `USER` 테이블의 모든 회원 정보를 조회합니다.
```sql
SELECT user_id, username, email FROM USER;
```

- **`UPDATE` (데이터 수정)**: `user_id`가 1인 회원의 `username`을 수정합니다.
```sql
UPDATE USER SET username = 'Google Gemini' WHERE user_id = 1;
```

- **`DELETE` (데이터 삭제)**: `user_id`가 1인 회원의 정보를 삭제합니다.
```sql
DELETE FROM USER WHERE user_id = 1;
```

---

#### **3. 시작을 위한 최고의 파트너: H2 데이터베이스**

실제 서비스에서는 **MySQL**, **PostgreSQL**, **Oracle** 같은 강력한 데이터베이스를 사용하지만, 처음 배우는 단계에서는 설치와 설정이 번거로울 수 있습니다. 이때 **H2**는 최고의 선택입니다.

-   **자바로 개발된 인메모리(In-Memory) 데이터베이스:** 별도의 설치 과정 없이, Spring Boot 프로젝트에 라이브러리만 추가하면 바로 실행됩니다.
-   **가볍고 빠름:** 애플리케이션이 실행될 때 메모리 위에서 동작하므로 속도가 매우 빠릅니다.
-   **개발 및 테스트에 최적화:** 애플리케이션이 종료되면 데이터가 함께 사라지는 '인메모리' 모드는, 테스트 실행 후 매번 데이터를 지워야 하는 번거로움을 없애줍니다. (물론 파일 기반 모드로 데이터를 영구 저장할 수도 있습니다.)
-   **H2 콘솔 제공:** 웹 브라우저를 통해 현재 데이터베이스의 테이블과 데이터를 직접 보고 SQL 쿼리를 실행해볼 수 있는 편리한 관리 화면을 제공합니다.

Spring Boot와 H2를 함께 사용하면, 복잡한 설정 없이 데이터베이스의 핵심 개념과 작동 방식을 익히는 데 온전히 집중할 수 있습니다.

#### **Spring Boot에서 H2 설정하기**

Spring Boot 프로젝트의 `src/main/resources/application.properties` 파일에 아래와 같이 간단한 설정만 추가하면 H2 데이터베이스를 사용할 수 있습니다.

```properties
# H2 데이터베이스 설정

# H2 콘솔 활성화
spring.h2.console.enabled=true

# 데이터소스(DataSource) 설정
# 연결할 데이터베이스의 경로 (인메모리 모드)
spring.datasource.url=jdbc:h2:mem:testdb
# 데이터베이스 드라이버 클래스 지정
spring.datasource.driver-class-name=org.h2.Driver
# 데이터베이스 접속 사용자 이름
spring.datasource.username=sa
# 데이터베이스 접속 비밀번호 (기본값은 비어있음)
spring.datasource.password=
```

- **`spring.h2.console.enabled=true`**: H2 콘솔을 활성화하여 웹 브라우저(`http://localhost:8080/h2-console`)에서 DB 상태를 볼 수 있게 합니다.
- **`spring.datasource.url`**: `jdbc:h2:mem:testdb`는 `testdb`라는 이름의 인메모리 데이터베이스를 사용하겠다는 의미입니다. 애플리케이션이 재시작되면 모든 데이터가 초기화됩니다.

---

### **요약**

-   **데이터베이스:** 데이터를 영구적으로, 체계적으로 저장하고 관리하는 시스템입니다.
-   **RDBMS:** 데이터를 '테이블' 단위로 저장하며, 테이블은 '행'과 '열'로 구성됩니다.
-   **PK (기본 키):** 각 데이터(행)를 식별하는 고유한 값입니다.
-   **FK (외래 키):** 테이블 간의 관계를 맺어주는 연결고리입니다.
-   **SQL:** 데이터베이스와 통신하기 위한 표준 언어입니다. (`CREATE`, `SELECT` 등)
-   **H2:** 설치가 필요 없고 가벼워서 Spring Boot 학습 및 개발 초기 단계에 사용하기 가장 좋은 인메모리 데이터베이스입니다.

### **출처 및 참고 자료**

-   **생활코딩 - 데이터베이스 (강의):**
    -   [https://opentutorials.org/course/3161](https://opentutorials.org/course/3161) (데이터베이스가 처음이라면 강력 추천)
-   **H2 데이터베이스 공식 사이트:**
    -   [https://www.h2database.com/html/main.html](https://www.h2database.com/html/main.html)
-   **Baeldung - Spring Boot with H2 Database:**
    - [https://www.baeldung.com/spring-boot-h2-database](https://www.baeldung.com/spring-boot-h2-database)